######################################################################
# Microsoft Visual C++ Makefile for the libpopcnt C/C++ library
######################################################################

CXX      = cl /nologo
CXXFLAGS = /W2 /O2 /EHsc
LINK     = link /nologo

#-----------------------------------------------------------------------------
# Default targets
#-----------------------------------------------------------------------------

all: test.obj

#-----------------------------------------------------------------------------
# Compilation rules
#-----------------------------------------------------------------------------

test.obj: $(@B).cpp
	$(CXX) $(CXXFLAGS) $** /Fo$@ /Fe$(@B).exe

#-----------------------------------------------------------------------------
# `nmake -f Makefile.msvc check` runs correctness tests
#-----------------------------------------------------------------------------

check test: test.obj
	test.exe

#-----------------------------------------------------------------------------
# Clean output directories
#-----------------------------------------------------------------------------

clean:
	-del *.exe *.obj
